{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/corrida.service\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"src/app/services/operario.service\";\nimport * as i4 from \"src/app/services/devolucion.service\";\nimport * as i5 from \"src/app/services/orden-produccion.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"../materia-prima/materia-prima-principal/materia-prima-principal.component\";\nimport * as i8 from \"../informacion-general/informacion-general-inicio/informacion-general-inicio.component\";\nimport * as i9 from \"../material-salida/material-salida-principal/material-salida-principal.component\";\nimport * as i10 from \"../reproceso/reproceso-principal/reproceso-principal.component\";\nimport * as i11 from \"../devolucion/devolucion-principal/devolucion-principal.component\";\nimport * as i12 from \"../retal/retal-principal/retal-principal.component\";\nimport * as i13 from \"../Torta/torta-principal/torta-principal.component\";\nimport * as i14 from \"../resumen-corrida/resumen-corrida-principal/resumen-corrida-principal.component\";\nimport * as i15 from \"../liquidacion-materiales/liquidacion-materiales-principal/liquidacion-materiales-principal.component\";\nimport * as i16 from \"../tiempo-paro/tiempo-paro-principal/tiempo-paro-principal.component\";\nimport * as i17 from \"../observaciones/observaciones-principal/observaciones-principal.component\";\nimport * as i18 from \"../corrida-extrusion-inicio/corrida-extrusion-inicio.component\";\nimport * as i19 from \"../corrida-extrusion-final/corrida-extrusion-final.component\";\n\nfunction CorridaExtrusionPrincipalComponent_app_corrida_extrusion_inicio_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-corrida-extrusion-inicio\", 6);\n    i0.ɵɵlistener(\"cambio\", function CorridaExtrusionPrincipalComponent_app_corrida_extrusion_inicio_1_Template_app_corrida_extrusion_inicio_cambio_0_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return ctx_r2.cerrarExtrusionInicio($event);\n    })(\"activarFinalizarCorrida\", function CorridaExtrusionPrincipalComponent_app_corrida_extrusion_inicio_1_Template_app_corrida_extrusion_inicio_activarFinalizarCorrida_0_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.activarFinalizarCorrida($event);\n    })(\"maquina\", function CorridaExtrusionPrincipalComponent_app_corrida_extrusion_inicio_1_Template_app_corrida_extrusion_inicio_maquina_0_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.enviarMaquina($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"CorridaNoFinalizada\", ctx_r0._corridaService.CorridaNoFinalizadaActivar)(\"ActualizarCorridaExtrusionInicio\", ctx_r0._corridaService.IngresarNuevaCorrida)(\"OperarioCorridaExtrusionInicio\", ctx_r0._corridaService.OperarioCorridaExtrusionInicio);\n  }\n}\n\nfunction CorridaExtrusionPrincipalComponent_app_corrida_extrusion_final_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-corrida-extrusion-final\", 7);\n    i0.ɵɵlistener(\"cambio\", function CorridaExtrusionPrincipalComponent_app_corrida_extrusion_final_3_Template_app_corrida_extrusion_final_cambio_0_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.cerrarExtrusionFinal($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"CorridaExtrusionFinalActualizar\", ctx_r1._corridaService.CorridaExtrusionFinal)(\"CorridaExtrusionFinalDesactivar\", ctx_r1._corridaService.CorridaExtrusionFinalDesactivar);\n  }\n}\n\nexport let CorridaExtrusionPrincipalComponent = /*#__PURE__*/(() => {\n  class CorridaExtrusionPrincipalComponent {\n    constructor(_corridaService, toastr, _operarioService, _devolucionService, _ordenProduccionService, datepipe) {\n      this._corridaService = _corridaService;\n      this.toastr = toastr;\n      this._operarioService = _operarioService;\n      this._devolucionService = _devolucionService;\n      this._ordenProduccionService = _ordenProduccionService;\n      this.datepipe = datepipe;\n      this.maquina = new EventEmitter();\n    }\n\n    ngOnInit() {\n      // With the following code i get the objects that are save in local storage when i have start the Corrida\n      // In fact that allows me to start the corrida and save the data\n      var ndatos = JSON.parse(localStorage.getItem(\"datos\") || '{}');\n      var nentrada = JSON.parse(localStorage.getItem(\"entrada\") || '{}');\n      var ninsertar = JSON.parse(localStorage.getItem(\"insertar\") || 'false'); // This condition of here verify the insert to another Corrida\n\n      if (ninsertar) {\n        this.insertarCorrida(ndatos, nentrada); // I restart the data\n\n        window.onbeforeunload = function () {\n          localStorage.setItem(\"datos\", JSON.stringify([]));\n          localStorage.setItem(\"entrada\", JSON.stringify([]));\n          localStorage.setItem(\"insertar\", JSON.stringify(false));\n        };\n      }\n    }\n\n    ngOnChanges() {} // It inserts the corrida\n\n\n    insertarCorrida(corrida, entrada) {\n      this._corridaService.saveCorridaExtrusion(corrida).subscribe(data => {\n        // this is for enable the button\n        this._corridaService.boton = true; // There are any data that it's send to the services\n\n        if (this._corridaService.InformacionActualizar) {\n          this._corridaService.InformacionActualizar = false;\n        } else {\n          this._corridaService.InformacionActualizar = true;\n        }\n\n        this._corridaService.OperarioCorridaExtrusionInicio = entrada;\n        this._corridaService.InformacionActualizarInicioFinal = true;\n\n        if (this._devolucionService.DevolucionActualizar) {\n          this._devolucionService.DevolucionActualizar = false;\n        } else {\n          this._devolucionService.DevolucionActualizar = true;\n        }\n\n        this.maquina.emit(corrida.maquina);\n        this._corridaService.CorridaExtrusion = data;\n        this.insertarOperarioCorridaExtrusion(entrada, data.pk_CorridaExtrusion);\n        this.activarFinalizarCorrida(true);\n        this._corridaService.CorridaExtrusionFinalDesactivar = true;\n      }, error => {\n        console.log(error);\n      });\n    } // Inserts the operator of the corrida extrusion\n\n\n    insertarOperarioCorridaExtrusion(entrada, pk_CorridaExtrusion) {\n      const operarioCorrida = {\n        fk_CorridaExtrusion: pk_CorridaExtrusion,\n        fk_Operario: entrada.operarioIncial,\n        fechaHora: entrada.fechaInicial\n      };\n\n      this._operarioService.saveOperarioCorridaExtrusion(operarioCorrida).subscribe(data => {\n        if (this._operarioService.OperarioActulizarInicio) {\n          this._operarioService.OperarioActulizarInicio = false;\n        } else {\n          this._operarioService.OperarioActulizarInicio = true;\n        }\n\n        this._operarioService.DatosOperarioCorridaInicio = data;\n        delete this._operarioService.DatosOperarioCorridaInicio['pk_OperarioCorridaExtrusion'];\n        this._corridaService.AceptarMaterialSalida = true;\n        this._corridaService.AceptarRetalExtrusion = true;\n        this._corridaService.AceptarTiempoParo = true;\n        this._corridaService.AceptarObservacion = true;\n        this._corridaService.AceptarTorta = true;\n        this._corridaService.AceptarDevolucion = true;\n        this._corridaService.AceptarRetal = true;\n        this._corridaService.AceptarMPri = true;\n        this._corridaService.DatosOperarioCorridaInicio = operarioCorrida;\n      }, error => {\n        console.log(error);\n      });\n    } // This functions allows enable and disable the component of Corrida Extrusion Final and Corrida Extrusion Inicio\n\n\n    IniciarNuevaCorrida() {\n      this.iniciarNuevaCorrida = true;\n    }\n\n    cerrarExtrusionInicio(entrada) {\n      this.iniciarNuevaCorrida = entrada;\n    }\n\n    FinalizarCorrida() {\n      this.finalizarCorrida = true;\n    }\n\n    cerrarExtrusionFinal(entrada) {\n      this.finalizarCorrida = entrada;\n    }\n\n    activarFinalizarCorrida(entrada) {\n      this.corridaIniciada = entrada;\n    }\n\n    enviarMaquina(entrada) {\n      this.maquina.emit(entrada);\n    }\n\n  }\n\n  CorridaExtrusionPrincipalComponent.ɵfac = function CorridaExtrusionPrincipalComponent_Factory(t) {\n    return new (t || CorridaExtrusionPrincipalComponent)(i0.ɵɵdirectiveInject(i1.CorridaService), i0.ɵɵdirectiveInject(i2.ToastrService), i0.ɵɵdirectiveInject(i3.OperarioService), i0.ɵɵdirectiveInject(i4.DevolucionService), i0.ɵɵdirectiveInject(i5.OrdenProduccionService), i0.ɵɵdirectiveInject(i6.DatePipe));\n  };\n\n  CorridaExtrusionPrincipalComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CorridaExtrusionPrincipalComponent,\n    selectors: [[\"app-corrida-extrusion-principal\"]],\n    inputs: {\n      OperarioActulizarInicio: \"OperarioActulizarInicio\",\n      OperarioActulizarFinalizar: \"OperarioActulizarFinalizar\"\n    },\n    outputs: {\n      maquina: \"maquina\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature],\n    decls: 16,\n    vars: 3,\n    consts: [[\"onkeydown\", \"return (event.keyCode == 154)\"], [3, \"CorridaNoFinalizada\", \"ActualizarCorridaExtrusionInicio\", \"OperarioCorridaExtrusionInicio\", \"cambio\", \"activarFinalizarCorrida\", \"maquina\", 4, \"ngIf\"], [3, \"CorridaExtrusionFinalActualizar\", \"CorridaExtrusionFinalDesactivar\", \"cambio\", 4, \"ngIf\"], [3, \"ActualizarInformacion\"], [1, \"corrita-extrusion-div-reproceso-devolucion\"], [1, \"corrita-extrusion-div-retal-torta-resumen-liquidacion\"], [3, \"CorridaNoFinalizada\", \"ActualizarCorridaExtrusionInicio\", \"OperarioCorridaExtrusionInicio\", \"cambio\", \"activarFinalizarCorrida\", \"maquina\"], [3, \"CorridaExtrusionFinalActualizar\", \"CorridaExtrusionFinalDesactivar\", \"cambio\"]],\n    template: function CorridaExtrusionPrincipalComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"body\", 0);\n        i0.ɵɵtemplate(1, CorridaExtrusionPrincipalComponent_app_corrida_extrusion_inicio_1_Template, 1, 3, \"app-corrida-extrusion-inicio\", 1);\n        i0.ɵɵelement(2, \"app-materia-prima-principal\");\n        i0.ɵɵtemplate(3, CorridaExtrusionPrincipalComponent_app_corrida_extrusion_final_3_Template, 1, 2, \"app-corrida-extrusion-final\", 2);\n        i0.ɵɵelement(4, \"app-informacion-general-inicio\", 3);\n        i0.ɵɵelement(5, \"app-material-salida-principal\");\n        i0.ɵɵelementStart(6, \"div\", 4);\n        i0.ɵɵelement(7, \"app-reproceso-principal\");\n        i0.ɵɵelement(8, \"app-devolucion-principal\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 5);\n        i0.ɵɵelement(10, \"app-retal-principal\");\n        i0.ɵɵelement(11, \"app-torta-principal\");\n        i0.ɵɵelement(12, \"app-resumen-corrida-principal\");\n        i0.ɵɵelement(13, \"app-liquidacion-materiales-principal\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(14, \"app-tiempo-paro-principal\");\n        i0.ɵɵelement(15, \"app-observaciones-principal\");\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.iniciarNuevaCorrida);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.finalizarCorrida);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ActualizarInformacion\", ctx._corridaService.InformacionActualizar);\n      }\n    },\n    directives: [i6.NgIf, i7.MateriaPrimaPrincipalComponent, i8.InformacionGeneralInicioComponent, i9.MaterialSalidaPrincipalComponent, i10.ReprocesoPrincipalComponent, i11.DevolucionPrincipalComponent, i12.RetalPrincipalComponent, i13.TortaPrincipalComponent, i14.ResumenCorridaPrincipalComponent, i15.LiquidacionMaterialesPrincipalComponent, i16.TiempoParoPrincipalComponent, i17.ObservacionesPrincipalComponent, i18.CorridaExtrusionInicioComponent, i19.CorridaExtrusionFinalComponent],\n    styles: [\".div-class-IniciarNuevaCorrida[_ngcontent-%COMP%]{margin-top:150px}.app-reproceso[_ngcontent-%COMP%]{margin-top:25px}.corrita-extrusion-div-reproceso-devolucion[_ngcontent-%COMP%]{width:41%;float:left;margin-left:8%}.corrita-extrusion-div-retal-torta-resumen-liquidacion[_ngcontent-%COMP%]{width:41%;float:left;margin-left:2%}\"]\n  });\n  return CorridaExtrusionPrincipalComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}